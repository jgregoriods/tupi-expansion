dev.off()
r <- raster("~/GIS/sam_test.tif")
plot(r)
sps <- spsample(r, 1000, "regular")
sps <- spsample(as(extent(r), "SpatialPolygons"), 1000, "regular")
plot(sps, add=T)
sps$attr <- extract(r, sps)
proj4string(sps) <- proj4string(r)
x <- filterPoints(sps, 150, attr)
plot(r)
plot(x, add=T)
plot(r)
x <- filterPoints(sps, 500, attr)
plot(x, add=T)
s
x
x$attr <- extract(x, r)
x$attr <- extract(r, x)
x <- filterPoints(x, 500, attr)
plot(x, add=T, color="blue")
plot(r)
plot(x, add=T, color="blue")
x <- filterPoints(x, 500, attr)
x$attr <- extract(r, x)
dev.off()
x <- filterPoints(x, 500, attr)
plot(r)
plot(x, add=T)
source("dispeRse.R")
a
r
b <- r
b[values(b) > 0] <- 1
plot(b)
orig <- c(-60,-10)
simulateDispersal(b, orig, 5000, 1.3)
b[!is.na(values(b))] <- 0
b[!is.na(values(b))] <- 1
plot(b)
simulateDispersal(b, orig, 5000, 1.3)
source("dispeRse.R")
iso <- simulateDispersal(b, orig, 5000, 1.3)
plot(iso, col=viridis(10))
library(viridisLite)
plot(iso, col=viridis(10))
source("dispeRse.R")
iso <- simulateDispersal(b, orig, 5000, 1.3)
plot(iso, col=viridis(10))
plot(iso, col=viridis(20))
vt <- raster("~/veg_test.tif")
plot(vt)
vt[values(vt) > 1] <- 10
plot(vt)
vt
plot(orig, add=T)
iso <- simulateDispersal(vt, orig, 5000, 1.3)
warnings()
plot(iso)
iso[values(iso)<=0] <- 0
plot(iso)
plot(iso, col=viridis(10))
source("dispeRse.R")
iso <- simulateDispersal(vt, orig, 5000, 1.3)
plot(iso)
source("dispeRse.R")
plot(iso)
iso <- simulateDispersal(vt, orig, 5000, 1.3)
plot(iso)
iso <- simulateDispersal(vt, orig, 5000, 1.78)
plot(iso)
vt <- raster("~/veg_test.tif")
vt[values(vt) > 1] <- 20
iso <- simulateDispersal(vt, orig, 5000, 1.78)
plot(iso)
plot(iso, col=viridis(5))
plot(iso, col=viridis(25))
plot(iso, col=viridis(20))
vt[values(vt) > 1] <- 5
iso <- simulateDispersal(vt, orig, 5000, 1.78)
plot(iso, col=viridis(20))
plot(iso, col=viridis(30))
plot(iso, col=viridis(10))
vt[values(vt) > 1] <- 33
iso <- simulateDispersal(vt, orig, 5000, 1.78)
plot(iso, col=viridis(10))
setwd("~/expand_tupi/")
source("utils.R")
testModels()
gc()
a <- testModels()
a
speed <- frontSpeed(0.02, 30, 30)
speed
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- CRS("+init=epsg:4326")
costSurface <- biomes
costSurface[values(costSurface) > 1] <- 5
costSurface
plot(costSurface)
sim <- simulateDispersal(costSurface, c(-61.9574, -10.9557), 5000, speed)
plot(sim)
sites <- read.csv("sites/tupi_filtered.csv")
coordinates(sites) <- ~Xadj+Yadj
plot(sites, add=T)
sites$tst <- extract(sim, sites)
spplot(sites, "tst")
sites$tst[is.na(sites$tst)] <- 0
spplot(sites, "tst")
sites$err <- abs(sites$tst - sites$bp)
spplot(sites, "err")
nrow(sites)
sites$err <- (sites$tst - sites$bp)^2
sum()
sum(sites$err)
sum(sites$err) / 232
sqrt(sum(sites$err) / 232)
sites$tst <- extract(sim, sites)
is.na(sites$tst)
sum(is.na(sites$tst)
)
162/232
source("utils.R")
a <- testModels()
a
gc()
source("utils.R")
a <- testModels()
a
source("utils.R")
a <- testModels()
a
source("utils.R")
a <- testModels()
a
frontSpeed(0.02, 30, 30)
frontSpeed(0.02, 40, 30)
frontSpeed(0.03, 40, 30)
frontSpeed(0.03, 50, 30)
frontSpeed(0.02, 50, 30)
s <- getScore("img/sim_dates.csv")
s
sim
plot(sim)
source("utils.R")
tm <- testModels()
tm
speed <- frontSpeed(0.025, 50, 30)
speed
costSurface
costSurface[values(costSurface)>1] <- 2
costSurface
orig <- c(-61.9574, -10.9557)
iso <-simulateDispersal(costSurface, orig, 5000, 1)
plot(iso)
costSurface[values(costSurface)>1] <- 5
iso <-simulateDispersal(costSurface, orig, 5000, 1)
plot(iso)
sites
sampleDates(iso, sites)
iso <-simulateDispersal(costSurface, orig, 5000, speed)
sampleDates(iso, sites)
source("utils.R")
plotSim(iso)
source("utils.R")
plotSim(iso)
costSurface[values(costSurface)>1] <- 4
sampleDates(iso, sites)
costSurface[values(costSurface)>1] <- 3
sampleDates(iso, sites)
costSurface[values(costSurface)>1] <- 2
sampleDates(iso, sites)
costSurface[values(costSurface)>1] <- 5
iso <-simulateDispersal(costSurface, orig, 5000, speed)
sampleDates(iso, sites)
costSurface[values(costSurface)>1] <- 4
iso <-simulateDispersal(costSurface, orig, 5000, speed)
sampleDates(iso, sites)
plotSim(iso)
source("utils.R")
plotSim(iso)
source("utils.R")
plotSim(iso)
source("utils.R")
plotSim(iso)
nm <- raster("null_model.asc
")
plot(nm
)
plot(nm, col=viridis(10))
plot(nm, col=viridis(9))
plot(nm, col=viridis(9), breaks=500*1:10)
world <- ne_countries(scale=50, returnclass="sf")
library(rnaturalearth)
world <- ne_countries(scale=50, returnclass="sf")
plot(world)
coast <- ne_coastline(scale=50, returnclass="sf")
plot(coast)
sam <- st_crop(coast, xmin=-85, xmax=-33, ymin=-60, ymax=12)
plotSim(iso)
plot(coast, add=T)
plotSim(iso)
plot(coast, add=T, col='black')
dev.off()
par(mfrow=c(1,2))
plotSim(iso)
plotSim(iso)
dev.off()
par(mfrow=c(1,2))
plotSim(iso)
plot(coast, add=T)
plotSim(iso)
plot(coast, add=T)
dev.off()
source("utils.R")
plotSim(iso)
dev.off()
par(mfrow=c(1,2))
plotSim(iso)
plotSim(iso)
dev.off()
source("utils.R")
source("utils.R")
plotSim(iso)
dev.off()
par(mfrow=c(1,2))
plotSim(iso)
plotSim(iso)
dev.off()
source("utils.R")
plotSim(iso)
dev.off()
par(mfrow=c(1,2))
plotSim(iso)
plotSim(iso)
dev.off()
source("utils.R")
plotSim(iso)
par(mfrow=c(2,2))
plotSim(iso)
plotSim(iso)
plotSim(iso)
plotSim(iso)
dev.off()
source("utils.R")
plotSim(iso, F)
dev.off()
par(mfrow=c(2,2))
plotSim(iso, F)
plotSim(iso, T)
source("utils.R")
dev.off()
par(mfrow=c(2,2))
plotSim(iso, T)
plotSim(iso)
plotSim(iso)
plotSim(iso)
plotSim(iso)
dev.off()
ls()
a
ls()
proj4string(nm) <- albers
plot(nm)
coast
plot(coast, add=T)
dev.off()
nm.d <- projectRaster(nm, iso)
plot(nm.d)
plotSim(nm.d)
dev.off()
source("log.R")
source("log.R")
frontSpeed(0.025, 50, 30)
source("log.R")
dev.off()
source("log.R")
dev.off()
source("log.R")
library(rasterVis)
source("utils.R")
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- wgs
speed <- frontSpeed(0.025, 50, 30)
origin <- c(-61.9574, -10.9557)
cost.null <- biomes
cost.null[values(cost.null) > 1] <- 1
iso.null <- simulateDispersal(cost.null, origin, 5000, speed)
cost.forest <- biomes
cost.forest[values(cost.forest) > 1] <- 4
iso.forest <- simulateDispersal(cost.forest, origin, 5000, speed)
nm <- raster("res/null_model.asc")
proj4string(nm) <- albers
fm <- raster("res/forest_model.asc")
proj4string(fm) <- albers
nm <- projectRaster(nm, iso.null)
fm <- projectRaster(fm, iso.null)
levelplot(stack(iso.null, iso.forest), at=500:1*10)
levelplot(stack(iso.null, iso.forest), at=500:1*10, col.regions=viridis(9))
plot(iso.null)
levelplot(c(iso.null, iso.forest), at=500:1*10, col.regions=viridis(9))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE), y=list(draw=F)))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE), y=list(draw=F)),
main='simBP')
coast <- ne_coastline(scale=50, returnclass="sp")
plot(coast)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F))) + layer(coast)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F))) + layer(sp.polygons(coast))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="") + layer(sp.polygons(coast))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="", colorkey=list(height=0.5, width=0.75))
+ layer(sp.polygons(coast))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="", colorkey=list(height=0.75, width=0.75)) + layer(sp.polygons(coast))
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="", colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
library(rasterVis)
source("utils.R")
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- wgs
speed <- frontSpeed(0.025, 50, 30)
origin <- c(-61.9574, -10.9557)
cost.null <- biomes
cost.null[values(cost.null) > 1] <- 1
iso.null <- simulateDispersal(cost.null, origin, 5000, speed)
cost.forest <- biomes
cost.forest[values(cost.forest) > 1] <- 4
iso.forest <- simulateDispersal(cost.forest, origin, 5000, speed)
nm <- raster("res/null_model.asc")
proj4string(nm) <- albers
fm <- raster("res/forest_model.asc")
proj4string(fm) <- albers
nm <- projectRaster(nm, iso.null)
fm <- projectRaster(fm, iso.null)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="", colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(pdf, "disperse.pdf")
dev.off()
library(rasterVis)
source("utils.R")
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- wgs
speed <- frontSpeed(0.025, 50, 30)
origin <- c(-61.9574, -10.9557)
cost.null <- biomes
cost.null[values(cost.null) > 1] <- 1
iso.null <- simulateDispersal(cost.null, origin, 5000, speed)
cost.forest <- biomes
cost.forest[values(cost.forest) > 1] <- 4
iso.forest <- simulateDispersal(cost.forest, origin, 5000, speed)
nm <- raster("res/null_model.asc")
proj4string(nm) <- albers
fm <- raster("res/forest_model.asc")
proj4string(fm) <- albers
nm <- projectRaster(nm, iso.null)
fm <- projectRaster(fm, iso.null)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="", colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg")
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="", colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, res=300)
dev.off()
library(rasterVis)
source("utils.R")
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- wgs
speed <- frontSpeed(0.025, 50, 30)
origin <- c(-61.9574, -10.9557)
cost.null <- biomes
cost.null[values(cost.null) > 1] <- 1
iso.null <- simulateDispersal(cost.null, origin, 5000, speed)
cost.forest <- biomes
cost.forest[values(cost.forest) > 1] <- 4
iso.forest <- simulateDispersal(cost.forest, origin, 5000, speed)
nm <- raster("res/null_model.asc")
proj4string(nm) <- albers
fm <- raster("res/forest_model.asc")
proj4string(fm) <- albers
nm <- projectRaster(nm, iso.null)
fm <- projectRaster(fm, iso.null)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, res=300)
dev.off()
library(rgdal)
coast <- readOGR("shp/south_america.shp")
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, res=300)
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1800, res=300)
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=2000, res=300)
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=400, res=300)
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=600, res=300)
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=900, res=300)
dev.off()
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=800, res=300)
dev.off()
library(rasterVis)
library(rgdal)
source("utils.R")
coast <- readOGR("shp/south_america.shp")
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- wgs
speed <- frontSpeed(0.025, 50, 30)
origin <- c(-61.9574, -10.9557)
cost.null <- biomes
cost.null[values(cost.null) > 1] <- 1
iso.null <- simulateDispersal(cost.null, origin, 5000, speed)
cost.forest <- biomes
cost.forest[values(cost.forest) > 1] <- 4
iso.forest <- simulateDispersal(cost.forest, origin, 5000, speed)
nm <- raster("res/null_model.asc")
proj4string(nm) <- albers
fm <- raster("res/forest_model.asc")
proj4string(fm) <- albers
nm <- projectRaster(nm, iso.null)
fm <- projectRaster(fm, iso.null)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=900, res=300)
dev.off()
levelplot(stack(nm, fm), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=900, res=300)
dev.off()
library(rasterVis)
library(rgdal)
source("utils.R")
coast <- readOGR("shp/south_america.shp")
biomes <- raster("layers/biomes.asc")
proj4string(biomes) <- wgs
speed <- frontSpeed(0.025, 50, 30)
origin <- c(-61.9574, -10.9557)
cost.null <- biomes
cost.null[values(cost.null) > 1] <- 1
iso.null <- simulateDispersal(cost.null, origin, 5000, speed)
cost.forest <- biomes
cost.forest[values(cost.forest) > 1] <- 4
iso.forest <- simulateDispersal(cost.forest, origin, 5000, speed)
nm <- raster("res/null_model.asc")
proj4string(nm) <- albers
fm <- raster("res/forest_model.asc")
proj4string(fm) <- albers
nm <- projectRaster(nm, iso.null)
fm <- projectRaster(fm, iso.null)
levelplot(stack(iso.null, iso.forest), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "disperse.jpg", width=1200, height=900, res=300)
dev.off()
levelplot(stack(nm, fm), at=500*1:10, col.regions=viridis(9),
names.attr=c("a", "b"), scales=list(x=list(draw=FALSE),
y=list(draw=F)), xlab="", ylab="",
colorkey=list(height=0.75, width=1)) + layer(sp.polygons(coast))
dev.print(jpeg, "sim.jpg", width=1200, height=900, res=300)
dev.off()
